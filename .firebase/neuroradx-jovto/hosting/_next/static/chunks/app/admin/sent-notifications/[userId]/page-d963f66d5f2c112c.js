(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7783],{38842:(e,s,t)=>{Promise.resolve().then(t.bind(t,3604))},3604:(e,s,t)=>{"use strict";t.d(s,{default:()=>v});var i=t(95155),a=t(12115),r=t(76046),n=t(65512),c=t(75828);let l=(0,c.createServerReference)("60cfcec8e45ef6e22f298f285b3fbf4f8a4d1c65bb",c.callServer,void 0,c.findSourceMapURL,"fetchUserWithNotifications");var o=t(73312),d=t(22130),m=t(38002),u=t(14505),f=t(87364),x=t(35288),h=t(66462),N=t(25121),j=t(13431),y=t(23580);let p=e=>{if(!e)return"N/A";try{return(0,j.GP)(new Date(e),"dd/MM/yyyy, HH:mm:ss")}catch(e){return"Invalid Date"}};function v(e){let{userId:s}=e,{t}=(0,n.B)(),c=(0,r.useRouter)(),[j,v]=(0,a.useState)(null),[b,w]=(0,a.useState)([]),[g,k]=(0,a.useState)(!0),[H,S]=(0,a.useState)(null),A=(0,a.useCallback)(async()=>{if(!s){S("User ID is missing from the URL."),k(!1);return}k(!0),S(null);try{let e=await l(s);if(e.success)v(e.user),w(e.notifications||[]);else throw Error(e.error||"Failed to fetch user history.")}catch(e){S(e.message)}finally{k(!1)}},[s]);return((0,a.useEffect)(()=>{A()},[A]),g)?(0,i.jsx)("div",{className:"container mx-auto py-8 flex justify-center items-center min-h-[60vh]",children:(0,i.jsx)(u.A,{className:"h-12 w-12 animate-spin text-primary"})}):(0,i.jsxs)("div",{className:"container mx-auto py-8",children:[(0,i.jsxs)(o.$,{onClick:()=>c.push("/admin/sent-notifications"),variant:"outline",className:"mb-6",children:[(0,i.jsx)(f.A,{className:"mr-2 h-4 w-4"})," ",t("admin.userNotificationsHistory.backToSentNotifications")]}),H&&(0,i.jsxs)(m.Fc,{variant:"destructive",children:[(0,i.jsx)(m.XL,{children:t("toast.errorTitle")}),(0,i.jsx)(m.TN,{children:H})]}),j&&(0,i.jsx)("div",{className:"mb-8",children:(0,i.jsx)(y.g,{user:j})}),(0,i.jsxs)(d.Zp,{children:[(0,i.jsxs)(d.aR,{children:[(0,i.jsxs)("div",{className:"flex justify-between items-center",children:[(0,i.jsxs)(d.ZB,{className:"flex items-center gap-3 text-2xl",children:[(0,i.jsx)(x.A,{className:"h-7 w-7 text-primary"}),t("admin.userNotificationsHistory.title")]}),(0,i.jsxs)(o.$,{variant:"outline",size:"sm",onClick:()=>c.push("/admin/send-notification?userId=".concat(s)),children:[(0,i.jsx)(h.A,{className:"mr-2 h-4 w-4"}),t("admin.userNotificationsHistory.sendNewButton")]})]}),(0,i.jsx)(d.BT,{children:t("admin.userNotificationsHistory.description")})]}),(0,i.jsx)(d.Wu,{className:"space-y-4",children:b.length>0?b.map(e=>(0,i.jsxs)(d.Zp,{className:"shadow-md",children:[(0,i.jsxs)(d.aR,{children:[(0,i.jsxs)("div",{className:"flex justify-between items-start",children:[(0,i.jsx)(d.ZB,{className:"text-lg font-semibold break-all",children:t(e.titleKey,e.messageParams)}),(0,i.jsx)(N.E,{variant:"read"===e.status?"secondary":"default",children:e.status})]}),(0,i.jsxs)(d.BT,{className:"text-xs text-muted-foreground",children:[t("admin.userNotificationsHistory.sentLabel"),p(e.createdAt)]})]}),(0,i.jsx)(d.Wu,{children:(0,i.jsx)("p",{className:"text-sm text-muted-foreground",children:t(e.messageKey,e.messageParams)})})]},e.id)):!H&&(0,i.jsx)("p",{className:"text-center text-muted-foreground py-8",children:t("admin.userNotificationsHistory.noNotifications")})})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[5520,8173,3431,1015,5512,1460,8441,1517,7358],()=>s(38842)),_N_E=e.O()}]);